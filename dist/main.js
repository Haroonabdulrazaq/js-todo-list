(()=>{const t=(t,e)=>{e.forEach((e=>{t.appendChild(e)}))},e=(t,e)=>{const i=document.createElement(t);return i.innerHTML=e,i},i=t=>{const e=document.createElement("div");return e.setAttribute("class",t),e},r=(t,e="")=>{const i=document.createElement(t);return""!=e&&i.setAttribute("class",e),i},s=localStorage.getItem("projects_store")?JSON.parse(localStorage.getItem("projects_store")):[],n=document.querySelector(".project-list"),a=a=>{const o=i("project card"),c=s.indexOf(a);o.setAttribute("p-index",c);const d=e("h3",a.title),l=r("i","del-project fa fa-trash"),u=r("i","edit-project fa fa-edit ghost"),p=r("input","edit-input");p.classList.add("hide"),p.setAttribute("placeholder","Enter new title here");const g=r("ul","task-list"),m=document.createElement("div"),h=document.createElement("form");let k=r("input","input");k.setAttribute("type","text");let v=r("input","task-submit button mt-4 is-info");v.setAttribute("type","submit"),v.setAttribute("value","Add Task"),t(h,[k,v]),t(m,[g,h]),t(o,[d,p,u,l,m]),n.appendChild(o),a.tasks.forEach((s=>{const n=r("li","task-item"),o=i("task-div"),c=r("input","task-checkbox");c.setAttribute("type","checkbox");const d=a.tasks.indexOf(s);o.setAttribute("t-index",d);const l=e("p",s.title),u=r("i","fa fa-edit ghost"),p=r("i","fa fa-trash");t(o,[c,l,u,p]),n.appendChild(o),g.appendChild(n)}))},o=()=>{if(document.querySelector(".project-list").innerHTML="",s.forEach(a),s.length>0){const t=document.querySelector(".project"),e=t.querySelector(".edit-project");t.addEventListener("mouseover",(t=>{e.classList.remove("ghost")})),t.addEventListener("mouseleave",(t=>{e.classList.add("ghost")}))}if(s.length>0&&s[0].tasks.length>0){const t=document.querySelector(".task-item .task-div"),e=t.querySelector(".fa-edit");t.addEventListener("mouseover",(t=>{e.classList.remove("ghost")})),t.addEventListener("mouseleave",(t=>{e.classList.add("ghost")}))}(t=>{var e;try{e=window.localStorage;var i="__storage_test__";return e.setItem(i,i),e.removeItem(i),!0}catch(t){return t instanceof DOMException&&(22===t.code||1014===t.code||"QuotaExceededError"===t.name||"NS_ERROR_DOM_QUOTA_REACHED"===t.name)&&e&&0!==e.length}})()&&localStorage.setItem("projects_store",JSON.stringify(s))},c=(t,e)=>0===e?t:c(t.parentNode,e-1),d=document.querySelector(".add-project"),l=document.querySelector(".new-project-form"),u=document.querySelector(".close-project-edit");d.addEventListener("click",(()=>{l.classList.toggle("hide")})),u.addEventListener("click",(()=>{l.classList.toggle("hide")})),document.querySelector(".create-project-btn").addEventListener("click",(t=>{const e=document.querySelector(".new-project-name").value;if(e.length>0){let t={title:e,tasks:[]};s.push(t),o()}}));const p=document.querySelector(".edit-task"),g=document.querySelector(".task-textarea");document.querySelector("main").addEventListener("click",(function(t){const e=(t,e)=>t.target&&t.target.matches(e),i=(t,e)=>{const i=p.getAttribute("pt-indices").split(",").map(Number);let[r,n]=[...i];s[r].tasks[n][t]=e};if(e(t,".description-submit")&&g.value.length>0&&(i("description",g),document.querySelector(".task-description p").innerHTML=g.value,g.classList.add("hide"),o()),e(t,".task-checkbox")){const e=t.target.parentNode.getAttribute("t-index"),i=c(t.target,5).getAttribute("p-index");s[i].tasks[e].completed=t.target.checked}if(e(t,"i.del-project")){const e=t.target.parentNode.getAttribute("p-index");s.splice(e,1),o()}if(e(t,"i.edit-project")){const e=t.target.parentNode.querySelector(".edit-input"),i=t.target.parentNode.getAttribute("p-index");e.classList.toggle("hide"),e.classList.contains("hide")||document.querySelector(".project-list").addEventListener("keyup",(function(t){t.preventDefault(),"Enter"===t.key&&e.value.length>0&&(s[i].title=e.value,o())}))}if(e(t,"input.task-submit")){t.preventDefault(),c(t.target,2).firstChild;const e=t.target.parentNode.firstChild.value,i=(c(t.target,2).firstChild,c(t.target,3).getAttribute("p-index")),r=s[i];if(""!=e.length){const t=((t,e="",i="",r="",s=!1,n="default")=>({title:t,description:e,dueDate:i,priority:r,completed:s,project:"default"}))(e);r.tasks.push(t),o()}}if(e(t,"button.del-task")){const e=t.target.parentNode.getAttribute("t-index"),i=(c(t.target,2).firstChild,c(t.target,2)),r=c(t.target,5).getAttribute("p-index");s[r].tasks.splice(e,1),i.remove()}if(e(t,".task-div p")||e(t,".task-div i")){const e=t.target.parentNode.getAttribute("t-index"),i=c(t.target,5).getAttribute("p-index"),r=s[i].tasks[e],n=document.querySelector(".task-title h3");p.classList.toggle("hide"),p.setAttribute("pt-indices",`${i}, ${e}`),n.innerHTML="Task: "+r.title,p.classList.contains("hide")&&p.removeAttribute("pt-indices"),o()}let r=document.querySelector(".task-title input");e(t,".task-title .title")&&(r.classList.remove("hide"),console.log(s)),r.classList.contains("hide")||document.querySelector("main").addEventListener("keyup",(function(t){t.preventDefault(),newTaskTitle=r.value,"Enter"===t.key&&r.value.length>0&&(i("title",newTaskTitle),r.classList.add("hide"),document.querySelector(".task-title .title").innerHTML="Task: "+newTaskTitle,o())})),e(t,".task-textarea")&&document.querySelector("main").addEventListener("keyup",(function(t){t.preventDefault(),"Enter"===t.key&&g.value.length>0&&(i("description",g),document.querySelector(".task-description p").innerHTML=g.value,g.classList.add("hide"),o())})),e(t,".task-description p")&&g.classList.toggle("hide"),e(t,'.task-priority input[name="taskPriority"]')&&i("priority",t.target.value),e(t,".close-edit i")&&p.classList.toggle("hide")})),document.querySelector(".date-input").addEventListener("change",(t=>{const e=p.getAttribute("pt-indices").split(",").map(Number);let[i,r]=[...e];s[i].tasks[r].dueDate=t.target.value})),o()})();